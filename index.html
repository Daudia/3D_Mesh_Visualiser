<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Surface 3D Paramétrable</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  </head>
  <body>
    <div id="ui">
      <div id="title">
        <h1>Visualiseur de Surface</h1>
        <div id="logo-placeholder">[ Logo / GIF ]</div>
      </div>

      <div class="section">
        <label for="functionInput">Fonction \( z = f(x, y) \)</label><br />
        <input
          type="text"
          id="functionInput"
          value="1 / ((x * x + 1)) + 1 / (((x - 2)*(x - 2) + 1))"
        />
        <button id="updateBtn">Mettre à jour</button>
      </div>

      <div class="section">
        <label>Affichage LaTeX :</label>
        <div id="latexDisplay">
          \( z = \frac{1}{x^2 + 1} + \frac{1}{(x-2)^2 + 1} \)
        </div>
      </div>

      <div class="section">
        <h3>Contrôles de caméra</h3>
        <label>Zoom</label>
        <input
          type="range"
          id="zoomControl"
          min="5"
          max="50"
          value="10"
        /><br />
        <label>Position X</label>
        <input type="range" id="camX" min="-10" max="10" value="0" /><br />
        <label>Position Y</label>
        <input type="range" id="camY" min="-10" max="10" value="5" />
      </div>

      <div class="section">
        <h3>Animation</h3>
        <label>Vitesse de rotation</label>
        <input
          type="range"
          id="rotationSpeed"
          min="-0.1"
          max="0.1"
          step="0.001"
          value="0.01"
        /><br />
        <label>Vitesse texture</label>
        <input
          type="range"
          id="textureSpeed"
          min="0"
          max="1"
          step="0.01"
          value="0.2"
        />
      </div>

      <div class="section">
        <h3>Texture</h3>
        <button class="textureBtn" data-texture="1">Option 1</button>
        <button class="textureBtn" data-texture="2">Option 2</button>
        <button class="textureBtn" data-texture="3">Option 3</button>
      </div>
      <div class="section" style="text-align: center; margin-top: 40px">
        <button id="toggleMenuBtn">❌ Masquer le menu</button>
      </div>
    </div>

    <div id="showMenuBtn">Réafficher le menu</div>

    <div id="canvasContainer"></div>

    <script src="main.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.js"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css"
    />
    <script>
      const input = document.getElementById("functionInput");
      const latexDisplay = document.getElementById("latexDisplay");

      function updateLatex() {
        try {
          const expression = input.value
            .replace(/\*\*/g, "^")
            .replace(/\*/g, " \\cdot ")
            .replace(/\//g, "\\frac");
          katex.render(`z = ${expression}`, latexDisplay, {
            throwOnError: false,
          });
        } catch (e) {
          latexDisplay.textContent = "Erreur de rendu";
        }
      }

      input.addEventListener("input", updateLatex);
      updateLatex();
    </script>
  </body>
</html>
