<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>Surface 3D Paramétrable</title>
    <link rel="stylesheet" href="style.css" />
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
  </head>
  <body>
    <div id="ui">
      <div id="title">
        <h1>Visualiseur de Surface</h1>
        <div id="logo-placeholder">[ Logo / GIF ]</div>
      </div>

      <div class="section">
        <label for="functionInput">Fonction \( z = f(x, y) \)</label><br />
        <input
          type="text"
          id="functionInput"
          value="(x * Math.sin(y) + y * Math.cos(x)) / 2"
        />
        <button id="updateBtn">Mettre à jour</button>
      </div>

      <div class="section">
        <label>Affichage LaTeX :</label>
        <div id="latexDisplay">
          \( z = \frac{1}{x^2 + 1} + \frac{1}{(x-2)^2 + 1} \)
        </div>
        <label for="presetSelect">Formules d'essai :</label>
        <select id="presetSelect">
          <option value="">-- Choisir une formule --</option>
          <option value="1 / ((x * x + 1)) + 1 / ((y * y + 1))">
            Crête double
          </option>
          <option value="Math.sin(x * 2) * Math.cos(y * 2)">
            Onde sinusoïdale
          </option>
          <option value="Math.sin(Math.sqrt(x * x + y * y) * 5)">
            Onde radiale
          </option>
          <option value="Math.sin(x) + Math.sin(y)">Vagues croisées</option>
          <option value="Math.sin(x * x - y * y)">Onde carrée radiale</option>
          <option
            value="Math.sin(10 * Math.atan2(y, x)) * Math.exp(-x * x - y * y)"
          >
            Explosion spirale
          </option>
          <option value="Math.sin(10 * x) * Math.sin(10 * y)">
            Pics en grille
          </option>
          <option value="Math.sin(x*y) * Math.cos(x + y)">
            Montagnes fractales
          </option>
          <option value="Math.atan2(y, x) * Math.sqrt(x*x + y*y)">
            Tourbillon polaire
          </option>
          <option value="Math.abs(Math.sin(3 * x) + Math.sin(3 * y))">
            Crêtes dentelées
          </option>
          <option value="Math.cos(x + y)">Valons diagonaux</option>
          <option value="-Math.abs(Math.sin(x) * Math.cos(y))">
            Fosse sinusoïdale
          </option>
          <option value="Math.sin(x * y) * Math.sin(y)">
            Champ d’interférence
          </option>
          <option value="Math.sign(Math.sin(x)) + Math.sign(Math.cos(y))">
            Onde carrée
          </option>
          <option value="-Math.sqrt(x*x + y*y)">Cône inversé</option>

          <option value="Math.cos(Math.sqrt(Math.abs(x * y)))">
            Réseau radial
          </option>
          <option value="Math.atan2(y, x) + Math.sin(3 * Math.sqrt(x*x + y*y))">
            Tourbillon perturbé
          </option>
          <option value="(x * Math.sin(y) + y * Math.cos(x)) / 2">
            Dynamique tordue
          </option>
          <option
            value="3*Math.exp(-Math.abs(x*y)) * Math.sin(4*x) * Math.cos(4*y)"
          >
            Fleur vibrante
          </option>
          <option value="Math.pow(Math.sin(x*x + y*y), 3)">
            Champs cubique
          </option>
          <option value="Math.abs(Math.sin(x * y)) * Math.sign(x - y)">
            Zébrures diagonales
          </option>
          <option value="Math.sin(10 * (x*x - y*y)) / (10 + x*x + y*y)">
            Lentilles interférentes
          </option>

          <option value="Math.sign(x*y) * Math.sin(Math.sqrt(Math.abs(x - y)))">
            Onde coupée
          </option>
          <option value="Math.atan2(Math.sin(y), Math.cos(x))">
            Torsion circulaire
          </option>
          <option
            value="Math.sin(Math.sqrt(x*x + y*y)) * Math.cos(Math.atan2(y, x))"
          >
            Sillage radial
          </option>
          <option
            value="Math.exp(-Math.pow(x*x + y*y, 0.3)) * Math.sin(6 * Math.sqrt(x*x + y*y))"
          >
            Cymatique douce
          </option>
          <option value="(Math.atan2(x, y) * Math.sin(x*x + y*y)) / 2">
            Tourbillon fractal
          </option>
          <option value="Math.sin(x + y + Math.sin(x*y))">
            Motif imbriqué
          </option>
          <option value="Math.sin(x) * Math.sin(y) + Math.cos(x + y)">
            Onde yin-yang
          </option>
          <option value="Math.sin(Math.atan2(y, x) + Math.sqrt(x*x + y*y))">
            Balance ondulée
          </option>
          <option value="Math.sin(x*x - y*y) * Math.cos(2 * x * y)">
            Symétrie inversée
          </option>
          <option
            value="Math.sin(Math.atan2(y, x) * 3) * Math.cos(Math.sqrt(x*x + y*y))"
          >
            Entrelac celtique
          </option>
          <option value="Math.sin(4 * Math.atan2(y, x)) * Math.sqrt(x*x + y*y)">
            Spirale ondulée
          </option>
          <option
            value="Math.sin(2 * Math.atan2(y, x)) + Math.cos(3 * Math.sqrt(x*x + y*y))"
          >
            Spirale croisée
          </option>
          <option value="Math.atan2(y, x) + Math.sin(x*x + y*y)">
            Tourbillon perturbé
          </option>
          <option
            value="Math.sin(5 * Math.atan2(y, x)) * Math.sin(2 * Math.sqrt(x*x + y*y))"
          >
            Spirale tressée
          </option>
          <option
            value="Math.floor(5 * Math.atan2(y, x)) + Math.sqrt(x*x + y*y)"
          >
            Escalier en colimaçon
          </option>
          <option
            value="Math.sin(Math.atan2(y, x) + 4 * Math.log(1 + x*x + y*y))"
          >
            Colimaçon logarithmique
          </option>
        </select>
      </div>

      <div class="section">
        <h3>Contrôles de caméra</h3>
        <label>Distance</label>
        <input
          type="range"
          id="zoomControl"
          min="5"
          max="50"
          value="10"
        /><br />

        <label>Angle horizontal (gauche ↔ droite)</label>
        <input type="range" id="camX" min="-180" max="180" value="0" /><br />

        <label>Angle vertical (haut ↕ bas)</label>
        <input type="range" id="camY" min="-90" max="90" value="30" />
      </div>

      <div class="section">
        <h3>Animation</h3>
        <label>Vitesse de rotation</label>
        <input
          type="range"
          id="rotationSpeed"
          min="-0.1"
          max="0.1"
          step="0.001"
          value="0.01"
        /><br />
        <label>Vitesse texture</label>
        <input
          type="range"
          id="textureSpeed"
          min="0"
          max="1"
          step="0.01"
          value="0.2"
        />
      </div>

      <div class="section">
        <h3>Texture</h3>
        <button class="textureBtn" data-texture="1">Option 1</button>
        <button class="textureBtn" data-texture="2">Option 2</button>
        <button class="textureBtn" data-texture="3">Option 3</button>
        <button class="textureBtn" data-texture="4">Option 4</button>
        <label for="colorPicker">Couleur dominante :</label>
        <input type="color" id="colorPicker" value="#e27df2" />
      </div>
      <div class="section">
        <label>Maillage wireframe</label>
        <input
          type="range"
          id="wireSegments"
          min="5"
          max="100"
          value="30"
          step="1"
        />
      </div>

      <div class="section" style="text-align: center; margin-top: 40px">
        <button id="toggleMenuBtn">❌ Masquer le menu</button>
      </div>
    </div>

    <div id="showMenuBtn">Réafficher le menu</div>

    <div id="canvasContainer"></div>

    <script src="main.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/katex.min.css"
    />
    <script>
      const input = document.getElementById("functionInput");
      const latexDisplay = document.getElementById("latexDisplay");

      function updateLatex() {
        try {
          const expression = input.value
            .replace(/\*\*/g, "^")
            .replace(/\*/g, " \\cdot ")
            .replace(/\//g, "\\frac");
          katex.render(`z = ${expression}`, latexDisplay, {
            throwOnError: false,
          });
        } catch (e) {
          latexDisplay.textContent = "Erreur de rendu";
        }
      }

      input.addEventListener("input", updateLatex);
      updateLatex();
    </script>
  </body>
</html>
